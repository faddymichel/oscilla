instr oscillator

iPartial = $partial

if iPartial == 0 then

iWaveFT vco2ift p4, iPartial

else

iWaveFT = -1

endif

aEnvelope oPort "envelope"

aAmplitude = aEnvelope * $velocity * .25 / 127
iFrequency = cpsmidinn ( $key ) * cent ( iPartial * 10 )

aSound poscil aAmplitude, iFrequency, iWaveFT

out aSound

endin
