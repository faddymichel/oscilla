instr oscillator

$plug(aInput)

iFrequency = cpsmidinn ( $key )

iWaveFT vco2ift iFrequency, 0

aEnvelope oPlug "envelope", -1

aAmplitude = aEnvelope * $velocity * .25 / 127
aFrequency = cent ( aEnvelope ) * iFrequency

aSound poscil aAmplitude, aFrequency, iWaveFT

out aInput + aSound

endin
